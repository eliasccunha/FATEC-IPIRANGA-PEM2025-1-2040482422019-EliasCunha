/*-------------------------------------------------------*
 *                      FATEC Ipiranga                    *
 * Disciplina: Programaçao Estruturada e Modular          *
 *          Prof. Veríssimo                               *
 *--------------------------------------------------------*
 * Objetivo do Programa: Estoque almoxarifado/ refatorar  *
 * Data - 02/03/2025                                      *
 * Autor: Elias Cesario da Cunha                          *
 *--------------------------------------------------------*/
#include <stdio.h>
#include <string.h>

void menu_estoque(){
    printf("Para entradada de item em estoque digite 1\n");
    printf("Para retirada de item em estoque digite 2\n");
    printf("Para verificar o estoque digite 3\n");
    printf("Para fechar o Programa digite 4\n");
    printf("digite o numero: ");
}

char limparGondola(char*item){
    
    return strcpy(*item, "");
}



int main()
{

    char estoque[3][10][5];
    int gaveta;
    char rua;
    int i, j;
    int confirmar = 1;
    int acao;
    int quantidade_de_item;
    int quantidadades[30];
    char codigo[5];

    for (int i = 0; i < 30; i++)
    {
      quantidadades[i] = 0;
    }
  

    for (int i = 0; i < 3; i++)
    {
        for (int j = 0; j < 10; j++)
        {
        
            limparGondola(*estoque[i][j]);
            // preencher o  estoque com espaços vazios
        }
    }
  

    while (1)
    {
    
       //instruçoes de comando de estoque
        menu_estoque();
        scanf("%d", &acao);    
            switch (acao)
            {
            case 1:
                // entrada de produto
                printf("informe a rua em qual ira armazenar o item A ,B OU C:");
                scanf(" %c", &rua);
                getchar();
                
                if (rua == 'A')
                {
                    i = 0;
                }
                else if (rua == 'B')
                {
                    i = 1;
                }
                else if (rua == 'C')
                {
                    i = 2;
                }

                printf("informe a gondola de 1 a 10:");
                scanf("%d", &j);
                j -= 1;
                //limpar o /0 do buffer para capturar a string na proxima linha
                getchar();
                
                //verifica se o a gondola esta vazia
                if (strcmp(estoque[i][j], "") == 0)
                {
                    printf("Informe o codigo do produto de ate 4 caracteres: ");
                    scanf("%s", estoque[i][j]);
                    printf("item %s sera armazenado na RUA %c Gondola %d \n",estoque[i][j] ,rua, j +1);
                    printf("Quantos items serao armazenados :");
                    scanf("%d", &quantidade_de_item);
                    quantidadades[j] += quantidade_de_item;
                    printf("%d adicionados ao estoque\n", quantidade_de_item);
                }
                else
                {
                    printf("ja tem o item %s armazenado neste local\n", estoque[i][j]);
                    printf("deseja adicionar mais quantidas?\n");
                    printf("(1) para sim  ou (2) para nao?\n");
                    scanf("%d", &confirmar);

                    if(confirmar == 1){
                        printf("informar a quantidade de items:");
                        scanf("%d", &quantidade_de_item);
                        quantidadades[j] += quantidade_de_item;
                        printf(" %d items adicionas\n", quantidade_de_item);
                    }
                }
                   

                break;

            case 2:
                // retirada de produtos
                printf("informe a rua em que ira retirar  o item A ,B OU C:");
                scanf(" %c", &rua);
                getchar();
                if (rua == 'A')
                {
                    i = 0;
                }
                else if (rua == 'B')
                {
                    i = 1;
                }
                else if (rua == 'C')
                {
                    i = 2;
                }

                printf("informe a gondola de (1 - 10):");
                scanf("%d", &j);
                j -= 1;
                getchar();

                if (strcmp(estoque[i][j], "") == 0)
                {
                    printf("Nenhum produto cadastrado neste local\n");
                    printf("\n");
                }
                else
                {
                    printf("quer realmente retirar o  item codigo: %s ?\n", estoque[i][j]);
                    printf("(1) para sim  ou (2) para nao?\n");
                    scanf("%d", &confirmar);
                    if (confirmar == 1)
                    {
                        printf("quantos itens serao retirados: ");
                        scanf("%d", &quantidade_de_item);
                        if((quantidadades[j] - quantidade_de_item) < 0)
                        {
                            printf("Items em estoque insuficiente , total de itens %s = %d\n", estoque[i][j] , quantidadades[j]);
                        }
                        else{
                            quantidadades[j] -= quantidade_de_item;
                            printf("pedido de retirada %d , %s confirmado!\n", quantidade_de_item, estoque[i][j]);
                            printf("item %s em estoque %d \n",estoque[i][j], quantidadades[j]);
                            
                            //se nao tem mais itens no local ele esvazia preencher estoque[i][j] com "";
                            if(quantidadades[j] == 0 ){
                                limparGondola(*estoque[i][j]);
                            }
                        }
                        
                    }
                    else
                    {
                        printf("pedido cancelado!\n");
                        printf("\n");
                    }
                
                    
                }
            
                break;

            case 3:
             
                  for (i = 0; i < 3; i++) {
                    if (i == 0) printf("\n--- RUA A ---\n");
                    else if (i == 1) printf("\n--- RUA B ---\n");
                    else if (i == 2) printf("\n--- RUA C ---\n");

                    for (j = 0; j < 10; j++) {
                        if (strcmp(estoque[i][j], "") == 0) {
                            printf("Gondola %d: vazia\n", j + 1);
                        } else {
                            printf("Gondola %d: Codigo %s: Quantidades[%d]\n", j + 1, estoque[i][j], quantidadades[j]);
                            }
                        }
                    }
                break;
            
            case 4:
             // Sair do programa
                printf("Fechando o programa...\n");
                return 0;
            
            default:
                printf("Opcao invalida\n");
            
                break;
            }
        }
    

    return 0;
}